<!DOCTYPE html>
<html>

<head>
    <title>Ajax 上传文件</title>

    <style>
        .line{
            width:500px;
            height:10px;
            background:#e2e2e1;
            border-radius:2px;
        }
        .innerLine{
            width:0px;
            height:10px;
            transition:all 0.5s;
            background:#25D97E;
        }
    </style>

</head>

<body>
    <div class="line">
        <div class="innerLine" id="innerLine"></div>
    </div>
    <br />
    <input type='file' id='file' name='myfile' />
    <input type='button' onclick='UpladFile()' value='上传' />


    <script type='text/javascript'>
        var innerLine = document.getElementById('innerLine');
        function UpladFile() {
            var fileObj = document.getElementById('file').files[0]; // 获取文件对象
            var FileController = 'http://localhost:1234/upload'; // 接收文件地址
            // FormData 对象
            var form = new FormData();
            form.append('file', fileObj); // 文件对象

            var xhr = new XMLHttpRequest();
            xhr.open('post', FileController, true);
            xhr.onload = function () {
                // alert('上传完成!');
            };
            xhr.upload.addEventListener('progress', progressFunction, false);
            xhr.send(form);
        }
        function progressFunction(evt) {
            if (evt.lengthComputable) {
                var person = Math.round(evt.loaded / evt.total );
                innerLine.style.width = 500 * person + "px";
            }
        }
    </script>
</body>